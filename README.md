# 陶瓷缺陷数据收集小程序

这是一个专门用于收集陶瓷产品缺陷图像数据的微信小程序，旨在为AI缺陷分类模型提供训练数据。支持本地存储和云端一键上传功能。

## 功能特性

### 📸 数据采集功能
- **拍照功能**：调用微信相机API进行拍照
- **缺陷分类**：支持7种缺陷类型选择（裂纹、气泡、变形、划痕、污渍、缺釉、正常）
- **位置信息**：自动记录采集位置（可选）

### ☁️ 云端数据管理
- **本地存储**：所有数据先保存在本地
- **一键上传**：支持批量上传全部本地数据到云端
- **上传状态**：实时显示上传进度和状态
- **数据同步**：自动跟踪已上传和待上传的数据

### 📊 数据管理功能
- **历史记录**：查看所有采集的数据记录
- **搜索筛选**：支持按关键词搜索和缺陷类型筛选
- **数据统计**：实时统计各类型缺陷数量和占比
- **记录删除**：支持删除不需要的记录

### 🎨 用户界面
- **现代化设计**：采用Material Design风格
- **响应式布局**：适配不同尺寸屏幕
- **流畅动画**：提供良好的用户体验
- **美观按键**：简化的缺陷类型选择界面

## 项目结构

```
ceramic-defect-collector/
├── pages/
│   ├── index/           # 首页（包含云端上传功能）
│   │   ├── index.wxml
│   │   ├── index.wxss
│   │   └── index.js
│   ├── collect/         # 数据收集页面（简化版）
│   │   ├── collect.wxml
│   │   ├── collect.wxss
│   │   └── collect.js
│   └── history/         # 历史记录页面（移除导出功能）
│       ├── history.wxml
│       ├── history.wxss
│       └── history.js
├── cloudfunctions/      # 云开发配置
├── images/              # 图片资源
├── app.js               # 全局应用逻辑
├── app.wxss             # 全局样式
├── app.json             # 应用配置（包含云开发）
└── project.config.json  # 项目配置
```

## 缺陷类型说明

| 类型 | 描述 | 特征 |
|------|------|------|
| 裂纹 | 陶瓷表面或内部的裂缝 | 线状、分叉状裂痕 |
| 气泡 | 烧制过程中产生的气泡 | 圆形或椭圆形凸起 |
| 变形 | 形状不规整或扭曲 | 整体或局部变形 |
| 划痕 | 表面划伤痕迹 | 线状凹痕 |
| 污渍 | 表面污染或色斑 | 颜色异常区域 |
| 缺釉 | 釉面缺失或不均匀 | 表面粗糙或露胎 |
| 正常 | 无明显缺陷的合格品 | 表面光滑、形状规整 |

## 技术实现

### 核心技术# 陶瓷缺陷数据收集小程序

这是一个专门用于收集陶瓷产品缺陷图像数据的微信小程序，旨在为AI缺陷分类模型提供训练数据。

## 功能特性

### 📸 数据采集功能
- **拍照功能**：调用微信相机API进行拍照
- **缺陷分类**：支持7种缺陷类型选择（裂纹、气泡、变形、划痕、污渍、缺釉、正常）
- **备注信息**：可添加详细的备注说明
- **位置信息**：自动记录采集位置（可选）

### 📊 数据管理功能
- **历史记录**：查看所有采集的数据记录
- **搜索筛选**：支持按关键词搜索和缺陷类型筛选
- **数据统计**：实时统计各类型缺陷数量和占比
- **数据导出**：支持数据导出和分享

### 🎨 用户界面
- **现代化设计**：采用Material Design风格
- **响应式布局**：适配不同尺寸屏幕
- **流畅动画**：提供良好的用户体验
- **深色模式**：支持系统深色模式

## 项目结构

```
ceramic-defect-collector/
├── pages/
│   ├── index/           # 首页
│   │   ├── index.wxml
│   │   ├── index.wxss
│   │   └── index.js
│   ├── collect/         # 数据收集页面
│   │   ├── collect.wxml
│   │   ├── collect.wxss
│   │   └── collect.js
│   └── history/         # 历史记录页面
│       ├── history.wxml
│       ├── history.wxss
│       └── history.js
├── images/              # 图片资源
├── app.js               # 全局应用逻辑
├── app.wxss             # 全局样式
├── app.json             # 应用配置
└── project.config.json  # 项目配置
```

## 缺陷类型说明

| 类型 | 描述 | 特征 |
|------|------|------|
| 裂纹 | 陶瓷表面或内部的裂缝 | 线状、分叉状裂痕 |
| 气泡 | 烧制过程中产生的气泡 | 圆形或椭圆形凸起 |
| 变形 | 形状不规整或扭曲 | 整体或局部变形 |
| 划痕 | 表面划伤痕迹 | 线状凹痕 |
| 污渍 | 表面污染或色斑 | 颜色异常区域 |
| 缺釉 | 釉面缺失或不均匀 | 表面粗糙或露胎 |
| 正常 | 无明显缺陷的合格品 | 表面光滑、形状规整 |

## 技术实现

### 核心技术
- **微信小程序框架**：使用原生小程序开发
- **微信云开发**：使用云数据库和云存储
- **本地存储**：使用wx.setStorageSync进行数据持久化
- **相机API**：调用wx.chooseMedia进行拍照
- **云端上传**：批量上传图片和数据到云端

### 数据结构
```javascript
// 本地数据记录结构
{
  id: "唯一标识符",
  imagePath: "图片本地路径",
  defectType: "缺陷类型",
  createTime: "创建时间(ISO格式)",
  location: {
    latitude: "纬度",
    longitude: "经度"
  }
}

// 云端数据记录结构
{
  _id: "云端自动生成",
  recordId: "本地记录ID",
  defectType: "缺陷类型",
  imagePath: "云存储图片fileID",
  createTime: "创建时间(ISO格式)",
  location: {
    latitude: "纬度",
    longitude: "经度"
  },
  uploadTime: "上传时间(ISO格式)"
}
```

## 安装使用

### 开发环境要求
- 微信开发者工具
- 微信小程序开发者账号
- 微信云开发环境

### 安装步骤
1. **创建小程序项目**
   - 下载并安装微信开发者工具
   - 创建新的小程序项目
   - 将代码文件复制到项目目录

2. **配置云开发**
   - 在微信开发者工具中开通云开发
   - 创建云开发环境并记录环境ID
   - 在`pages/index/index.js`中替换环境ID

3. **配置数据库和存储**
   - 创建数据库集合`ceramic_records`
   - 创建云存储文件夹`ceramic-images`
   - 设置相应的读写权限

4. **添加图片资源**
   - 根据下方资源清单添加所需图标
   - 确保图片路径与代码中引用一致

5. **测试运行**
   - 在开发者工具中编译和预览
   - 测试拍照、保存、上传功能

### 权限配置
在`app.json`中已配置以下权限：
- `scope.camera`：访问摄像头权限
- `scope.writePhotosAlbum`：保存到相册权限
- `cloud: true`：启用云开发

## 图片资源

需要准备以下图片资源：

### 基础图标（32x32px）
- `home.png` / `home-active.png` - 首页图标
- `camera.png` / `camera-active.png` - 相机图标
- `history.png` / `history-active.png` - 历史图标
- `search.png` - 搜索图标
- `arrow-down.png` - 下拉箭头
- `location.png` - 位置图标
- `close.png` - 关闭图标
- `delete.png` - 删除图标
- `id.png` - ID图标

### 功能图标（40x40px）
- `camera-white.png` - 白色相机图标
- `camera-gray.png` - 灰色相机图标
- `history-white.png` - 白色历史图标
- `save-white.png` - 白色保存图标
- `cloud-upload.png` - 云上传图标

### 其他资源
- `ceramic-logo.png` - 应用logo（120x120px）
- `empty.png` - 空状态图标（120x120px）
- `success.png` - 成功图标（100x100px）

## 云开发配置

### 环境配置
1. **开通云开发**：在微信开发者工具中开通云开发服务
2. **创建环境**：创建云开发环境并获取环境ID
3. **配置环境ID**：在代码中替换`your-env-id`为实际环境ID

### 数据库配置
创建集合 `ceramic_records`，包含以下字段：
- `recordId`: 本地记录ID
- `defectType`: 缺陷类型
- `imagePath`: 云存储图片fileID
- `createTime`: 创建时间
- `location`: 位置信息
- `uploadTime`: 上传时间

### 云存储配置
创建文件夹 `ceramic-images` 用于存储上传的图片

## 主要功能说明

### 1. 数据采集
- 点击拍照按钮调用相机
- 选择7种缺陷类型之一
- 自动获取位置信息（可选）
- 数据保存到本地存储

### 2. 云端上传
- 首页显示待上传数据数量
- 一键批量上传所有本地数据
- 实时显示上传进度和状态
- 自动跟踪已上传记录

### 3. 历史记录
- 查看所有本地记录
- 按缺陷类型筛选
- 搜索功能
- 删除不需要的记录

## 注意事项

### 开发注意事项
1. **环境ID配置**：必须配置正确的云开发环境ID
2. **权限设置**：确保数据库和存储权限正确设置
3. **网络依赖**：云端上传功能需要网络连接
4. **存储配额**：注意云开发免费配额限制

### 使用注意事项
1. **图片质量**：建议在良好光线下拍照
2. **网络环境**：上传时确保网络连接稳定
3. **数据备份**：本地数据可能因小程序删除而丢失
4. **定期上传**：建议定期上传数据到云端

## 版本更新

### v2.0.0 - 云开发版本
- ✅ 集成微信云开发服务
- ✅ 添加一键上传全部数据功能
- ✅ 移除备注功能，简化界面
- ✅ 移除导出功能，专注云端存储
- ✅ 优化缺陷类型选择界面
- ✅ 改进统计显示（增加已上传数量）

### v1.0.0 - 基础版本
- 基础的数据采集和管理功能
- 本地存储和导出功能

## 扩展功能建议

### 可考虑的增强功能
- 数据分析和统计图表
- 批量删除功能
- 数据导入功能
- 用户权限管理
- 数据标注功能
- 离线数据同步优化

## 常见问题

### Q: 云开发环境如何配置？
A: 参考云开发配置部分，需要开通云开发并创建环境。

### Q: 上传失败怎么办？
A: 检查网络连接和云开发权限配置，确保数据库和存储权限正确。

### Q: 数据会丢失吗？
A: 本地数据可能因小程序删除而丢失，建议及时上传到云端。

### Q: 有配额限制吗？
A: 云开发免费版有存储和数据库配额限制，超出需要付费。

## 贡献指南

欢迎提交Issue和Pull Request来改进这个项目。贡献代码前请确保：
1. 代码风格保持一致
2. 添加必要的注释
3. 测试功能正常运行
4. 更新相关文档

## 许可证

本项目采用MIT许可证，详情请参阅LICENSE文件。